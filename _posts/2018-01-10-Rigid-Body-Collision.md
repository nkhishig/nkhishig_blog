
## Rigid Body Collision Theory  

For two rigid bodies in collision the equations of motion are determined using the concept of impulse. We make the assumption that the collision happens quickly enough that there is no change in the position or orientation of the bodies. Also we do not account for friction when computing the forces in the system, allowing only the force in the direction perpendicular to the edge of the bodies during the collision, noted by the unit vector $$\vec{n}$$. 

The bodies experience impulse of equal but opposite value during the collision due to which the velocity of the center of mass of the bodies after the collision are  
\begin{equation}
\vec{V_{af}} = \vec{V_{ai}}+\frac{j}{m_{a}}\vec{n} 
\end{equation}
\begin{equation}
\vec{V_{bf}} = \vec{V_{bi}}-\frac{j}{m_{b}}\vec{n}
\end{equation}

where $$\vec{V_{af}}$$ is the final velocity after collision, $$\vec{V_{ai}}$$ is the initial velocity before collision, $$m_{a}$$ is the mass of the body A and j is the impulse parameter.  

To simulate a simple collision of a rigid body to the ground, we allow the second rigid body to be the ground by assuming it is stationary $$(\vec{V_{bi}}=0)$$ and its mass infinite $$(m_{b}\rightarrow\infty)$$. Therefore, we only keep track of the velocity of the first body given by the equation (1a) and using the notion of impulse, its angular velocity after collision can be similarly determined, 
\begin{equation}
\omega_{af} = \omega_{ai}+\frac{\left(\vec{r}\times j\vec{n}\right)}{I_{a}}
\end{equation} 
where r is the distance vector from the center of mass of the rigid body to the collision point and $$I_{a}$$ is the moment of inertia of the body. 
Since the second rigid body is the ground, the impulse parameter j was simplified to be 
\begin{equation}
j=-\frac{(e+1) \vec{V_{\text{ap}}}\cdot \vec{n} }{\frac{\left(\vec{r}\times \vec{n}\right){}^2}{I_a}+\frac{1}{m_a}}
\end{equation}
where e is the elasticity of the collision, $$\vec{V_{\text{ap}}}$$ is the initial velocity of the impact point on the rigid body before collision. 
With
\begin{equation}
\vec{V_{\text{ap}}} = \vec{V_{ai}}+\omega_{ai}\times\vec{r}
\end{equation}
and the moment of inertia of the rigid body, 
\begin{equation}
I_{a} = \frac{m_{a}}{12}\left(w^2+h^2\right)
\end{equation}
and the direction perpendicular to the ground equal to,
\begin{equation}
\vec{n}=\hat{y}
\end{equation}
evaluating the impulse parameter j  
\begin{equation}
j=-\frac{\left(1+e\right)\left(V_{y}+\omega r_{x}\right)}{I_{a}+m_ar_{x}^2}I_{a}
\end{equation}
and the final expression of the vertical velocity of the center of mass of the body becomes 
\begin{equation}
V_{af}=V_{ai}-\frac{\left(1+e\right)\left(w^2+h^2\right)\left(V_{y}+\omega r_{x}\right)}{\left(w^2+h^2+12r_{x}^2\right)}
\end{equation}
and the angular velocity of the body is 
\begin{equation}
\omega_{af}=\omega_{ai}-\frac{12r_{x}\left(1+e\right)\left(V_{y}+\omega r_{x}\right)}{\left(w^2+h^2+12r_{x}^2\right)}
\end{equation}
Here $$V_{y}$$ is the vertical velocity component of $$V_{ai}$$.
Note there is no change introduced in the horizontal velocity component after collision since the impulse is only present in $$\hat{y}$$ and therefore is negligible in the simulation. 

## Coding the motion
Verlet integration method was used to model the motion of the rigid body in order to make it easier for adding new parameters and modifications. 

<math xmlns='http://www.w3.org/1998/Math/MathML'
    mathematica:form='StandardForm'
    xmlns:mathematica='http://www.wolfram.com/XML/'>
<mrow>
  <mi>Module</mi>
  <mo>[</mo>
  <mrow>
   <mrow>
    <mo>{</mo>
    <mrow>
     <mrow>
      <mi>a</mi>
      <mo>=</mo>
      <mn>2</mn>
     </mrow>
     <mo>,</mo>
     <mtext> </mtext>
     <mrow>
      <mi>b</mi>
      <mo>=</mo>
      <mn>2</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>yi</mi>
      <mo>=</mo>
      <mn>10</mn>
     </mrow>
     <mo>,</mo>
     <mtext> </mtext>
     <mrow>
      <mi>vi</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mo>,</mo>
     <mtext> </mtext>
     <mrow>
      <mi>&#948;t</mi>
      <mo>=</mo>
      <mn>0.01</mn>
     </mrow>
     <mo>,</mo>
     <mtext> </mtext>
     <mrow>
      <mi>&#952;i</mi>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <mn>30</mn>
        <mn>180</mn>
       </mfrac>
       <mo>&#8290;</mo>
       <mi>&#960;</mi>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mtext> </mtext>
     <mrow>
      <mi>e</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
    <mo>}</mo>
   </mrow>
   <mo>,</mo>
   <mtext>&#62371;</mtext>
   <mrow>
    <mrow>
     <msub>
      <mi>&#969;</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <msub>
      <mi>&#969;</mi>
      <mn>2</mn>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mi>yi</mi>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <msub>
      <mi>v</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mi>vi</mi>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <msub>
      <mi>v</mi>
      <mn>2</mn>
     </msub>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <msub>
      <mi>&#952;</mi>
      <mn>1</mn>
     </msub>
     <mo>=</mo>
     <mi>&#952;i</mi>
    </mrow>
    <mo>;</mo>
    <mtext>&#62371;</mtext>
    <mrow>
     <mi>For</mi>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mi>t</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mtext> </mtext>
      <mrow>
       <mi>t</mi>
       <mo>&lt;</mo>
       <mn>10</mn>
      </mrow>
      <mo>,</mo>
      <mtext> </mtext>
      <mrow>
       <mi>t</mi>
       <mo>+=</mo>
       <mi>&#948;t</mi>
      </mrow>
      <mo>,</mo>
      <mtext>&#62371;</mtext>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <mi>AppendTo</mi>
         <mo>[</mo>
         <mrow>
          <mi>list2</mi>
          <mo>,</mo>
          <msub>
           <mi>y</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>,</mo>
        <mtext> </mtext>
        <mrow>
         <mi>AppendTo</mi>
         <mo>[</mo>
         <mrow>
          <mi>list3</mi>
          <mo>,</mo>
          <msub>
           <mi>&#952;</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>AppendTo</mi>
         <mo>[</mo>
         <mrow>
          <mi>list4</mi>
          <mo>,</mo>
          <msub>
           <mi>&#969;</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>,</mo>
        <mtext> </mtext>
        <mrow>
         <mi>AppendTo</mi>
         <mo>[</mo>
         <mrow>
          <mi>list5</mi>
          <mo>,</mo>
          <mtext> </mtext>
          <msub>
           <mi>v</mi>
           <mn>1</mn>
          </msub>
         </mrow>
         <mo>]</mo>
        </mrow>
        <mo>,</mo>
        <mtext>&#62371;</mtext>
        <mrow>
         <msub>
          <mi>&#952;</mi>
          <mn>1</mn>
         </msub>
         <mo>=</mo>
         <mrow>
          <msub>
           <mi>&#952;</mi>
           <mn>1</mn>
          </msub>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>&#969;</mi>
            <mn>1</mn>
           </msub>
           <mo>&#8290;</mo>
           <mi>&#948;t</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mtext>&#62371;</mtext>
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mo>=</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mn>1</mn>
          </msub>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>v</mi>
            <mn>1</mn>
           </msub>
           <mo>&#8290;</mo>
           <mi>&#948;t</mi>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>4.9</mn>
           <mrow>
            <mi>&#948;t</mi>
            <mo>^</mo>
            <mn>2</mn>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mtext>&#62371;</mtext>
        <mrow>
         <msub>
          <mi>v</mi>
          <mn>1</mn>
         </msub>
         <mo>=</mo>
         <mtext> </mtext>
         <mrow>
          <msub>
           <mi>v</mi>
           <mn>1</mn>
          </msub>
          <mo>-</mo>
          <mrow>
           <mn>9.8</mn>
           <mi>&#948;t</mi>
          </mrow>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mtext>&#62371;</mtext>
        <mrow>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
         <mo>=</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mn>1</mn>
          </msub>
          <mo>+</mo>
          <mrow>
           <msub>
            <mi>v</mi>
            <mn>1</mn>
           </msub>
           <mo>&#8290;</mo>
           <mi>&#948;t</mi>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mn>4.9</mn>
           <mrow>
            <mi>&#948;t</mi>
            <mo>^</mo>
            <mn>2</mn>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <mo>,</mo>
        <mtext>&#62371;</mtext>
        <mrow>
         <mi>If</mi>
         <mo>[</mo>
         <mrow>
          <mrow>
           <mrow>
            <msub>
             <mi>y</mi>
             <mn>2</mn>
            </msub>
            <mo>+</mo>
            <mrow>
             <msub>
              <mi>r</mi>
              <mi>y</mi>
             </msub>
             <mo>[</mo>
             <mrow>
              <mrow>
               <mi>n</mi>
               <mo>[</mo>
               <msub>
                <mi>&#952;</mi>
                <mn>1</mn>
               </msub>
               <mo>]</mo>
              </mrow>
              <mo>,</mo>
              <msub>
               <mi>&#952;</mi>
               <mn>1</mn>
              </msub>
             </mrow>
             <mo>]</mo>
            </mrow>
           </mrow>
           <mo>&lt;</mo>
           <mn>0</mn>
          </mrow>
          <mo>,</mo>
          <mtext> </mtext>
          <mtext>&#62371;</mtext>
          <mrow>
           <mo>{</mo>
           <mrow>
            <mrow>
             <msub>
              <mi>y</mi>
              <mn>1</mn>
             </msub>
             <mo>&#10869;</mo>
             <mrow>
              <mo>-</mo>
              <mrow>
               <msub>
                <mi>r</mi>
                <mi>y</mi>
               </msub>
               <mo>[</mo>
               <mrow>
                <mrow>
                 <mi>n</mi>
                 <mo>[</mo>
                 <msub>
                  <mi>&#952;</mi>
                  <mn>1</mn>
                 </msub>
                 <mo>]</mo>
                </mrow>
                <mo>,</mo>
                <msub>
                 <mi>&#952;</mi>
                 <mn>1</mn>
                </msub>
               </mrow>
               <mo>]</mo>
              </mrow>
             </mrow>
            </mrow>
            <mo>,</mo>
            <mtext>&#62371;</mtext>
            <mrow>
             <msub>
              <mi>&#969;</mi>
              <mn>2</mn>
             </msub>
             <mo>=</mo>
             <mrow>
              <msub>
               <mi>&#969;</mi>
               <mn>1</mn>
              </msub>
              <mo>-</mo>
              <mrow>
               <mn>12</mn>
               <mo>&#8290;</mo>
               <mrow>
                <msub>
                 <mi>r</mi>
                 <mi>x</mi>
                </msub>
                <mo>[</mo>
                <mrow>
                 <mrow>
                  <mi>n</mi>
                  <mo>[</mo>
                  <msub>
                   <mi>&#952;</mi>
                   <mn>1</mn>
                  </msub>
                  <mo>]</mo>
                 </mrow>
                 <mo>,</mo>
                 <msub>
                  <mi>&#952;</mi>
                  <mn>1</mn>
                 </msub>
                </mrow>
                <mo>]</mo>
               </mrow>
               <mo>&#8290;</mo>
               <mrow>
                <mo>(</mo>
                <mn>2</mn>
                <mo>)</mo>
               </mrow>
               <mo>&#8290;</mo>
               <mrow>
                <mrow>
                 <mo>(</mo>
                 <mrow>
                  <msub>
                   <mi>v</mi>
                   <mn>1</mn>
                  </msub>
                  <mo>+</mo>
                  <mrow>
                   <msub>
                    <mi>&#969;</mi>
                    <mn>1</mn>
                   </msub>
                   <mo>*</mo>
                   <mrow>
                    <msub>
                     <mi>r</mi>
                     <mi>x</mi>
                    </msub>
                    <mo>[</mo>
                    <mrow>
                     <mrow>
                      <mi>n</mi>
                      <mo>[</mo>
                      <msub>
                       <mi>&#952;</mi>
                       <mn>1</mn>
                      </msub>
                      <mo>]</mo>
                     </mrow>
                     <mo>,</mo>
                     <msub>
                      <mi>&#952;</mi>
                      <mn>1</mn>
                     </msub>
                    </mrow>
                    <mo>]</mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo>)</mo>
                </mrow>
                <mo>/</mo>
                <mrow>
                 <mo>(</mo>
                 <mrow>
                  <msup>
                   <mi>a</mi>
                   <mn>2</mn>
                  </msup>
                  <mo>+</mo>
                  <msup>
                   <mi>b</mi>
                   <mn>2</mn>
                  </msup>
                  <mo>+</mo>
                  <mrow>
                   <mn>12</mn>
                   <mo>&#8290;</mo>
                   <msup>
                    <mrow>
                     <mo>(</mo>
                     <mrow>
                      <msub>
                       <mi>r</mi>
                       <mi>x</mi>
                      </msub>
                      <mo>[</mo>
                      <mrow>
                       <mrow>
                        <mi>n</mi>
                        <mo>[</mo>
                        <msub>
                         <mi>&#952;</mi>
                         <mn>1</mn>
                        </msub>
                        <mo>]</mo>
                       </mrow>
                       <mo>,</mo>
                       <msub>
                        <mi>&#952;</mi>
                        <mn>1</mn>
                       </msub>
                      </mrow>
                      <mo>]</mo>
                     </mrow>
                     <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                   </msup>
                  </mrow>
                 </mrow>
                 <mo>)</mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
            <mo>,</mo>
            <mtext>&#62371;</mtext>
            <mrow>
             <msub>
              <mi>v</mi>
              <mn>2</mn>
             </msub>
             <mo>=</mo>
             <mrow>
              <msub>
               <mi>v</mi>
               <mn>1</mn>
              </msub>
              <mo>-</mo>
              <mrow>
               <mrow>
                <mo>(</mo>
                <mrow>
                 <mrow>
                  <mo>(</mo>
                  <mrow>
                   <msup>
                    <mi>a</mi>
                    <mn>2</mn>
                   </msup>
                   <mo>+</mo>
                   <msup>
                    <mi>b</mi>
                    <mn>2</mn>
                   </msup>
                  </mrow>
                  <mo>)</mo>
                 </mrow>
                 <mo>&#8290;</mo>
                 <mrow>
                  <mo>(</mo>
                  <mn>2</mn>
                  <mo>)</mo>
                 </mrow>
                 <mo>&#8290;</mo>
                 <mrow>
                  <mo>(</mo>
                  <mrow>
                   <msub>
                    <mi>v</mi>
                    <mn>1</mn>
                   </msub>
                   <mo>+</mo>
                   <mrow>
                    <msub>
                     <mi>&#969;</mi>
                     <mn>1</mn>
                    </msub>
                    <mo>*</mo>
                    <mrow>
                     <msub>
                      <mi>r</mi>
                      <mi>x</mi>
                     </msub>
                     <mo>[</mo>
                     <mrow>
                      <mrow>
                       <mi>n</mi>
                       <mo>[</mo>
                       <msub>
                        <mi>&#952;</mi>
                        <mn>1</mn>
                       </msub>
                       <mo>]</mo>
                      </mrow>
                      <mo>,</mo>
                      <msub>
                       <mi>&#952;</mi>
                       <mn>1</mn>
                      </msub>
                     </mrow>
                     <mo>]</mo>
                    </mrow>
                   </mrow>
                  </mrow>
                  <mo>)</mo>
                 </mrow>
                </mrow>
                <mo>)</mo>
               </mrow>
               <mo>/</mo>
               <mrow>
                <mo>(</mo>
                <mrow>
                 <msup>
                  <mi>a</mi>
                  <mn>2</mn>
                 </msup>
                 <mo>+</mo>
                 <msup>
                  <mi>b</mi>
                  <mn>2</mn>
                 </msup>
                 <mo>+</mo>
                 <mrow>
                  <mn>12</mn>
                  <mo>&#8290;</mo>
                  <msup>
                   <mrow>
                    <mo>(</mo>
                    <mrow>
                     <msub>
                      <mi>r</mi>
                      <mi>x</mi>
                     </msub>
                     <mo>[</mo>
                     <mrow>
                      <mrow>
                       <mi>n</mi>
                       <mo>[</mo>
                       <msub>
                        <mi>&#952;</mi>
                        <mn>1</mn>
                       </msub>
                       <mo>]</mo>
                      </mrow>
                      <mo>,</mo>
                      <msub>
                       <mi>&#952;</mi>
                       <mn>1</mn>
                      </msub>
                     </mrow>
                     <mo>]</mo>
                    </mrow>
                    <mo>)</mo>
                   </mrow>
                   <mn>2</mn>
                  </msup>
                 </mrow>
                </mrow>
                <mo>)</mo>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
            <mo>,</mo>
            <mtext>&#62371;</mtext>
            <mrow>
             <msub>
              <mi>&#969;</mi>
              <mn>1</mn>
             </msub>
             <mo>=</mo>
             <msub>
              <mi>&#969;</mi>
              <mn>2</mn>
             </msub>
            </mrow>
            <mo>,</mo>
            <mtext>&#62371;</mtext>
            <mrow>
             <msub>
              <mi>v</mi>
              <mn>1</mn>
             </msub>
             <mo>=</mo>
             <msub>
              <mi>v</mi>
              <mn>2</mn>
             </msub>
            </mrow>
           </mrow>
           <mtext>&#62371;</mtext>
           <mo>}</mo>
          </mrow>
         </mrow>
         <mo>]</mo>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <mo>]</mo>
 </mrow>
</math>


## Calculating energy and checking its conservation 



